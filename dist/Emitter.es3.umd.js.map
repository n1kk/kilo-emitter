{"version":3,"sources":["../src/Emitter.ts"],"names":[],"mappings":"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","file":"Emitter.es3.umd.js","sourcesContent":["export interface Listener extends Function {\n  $ctx ?: object;\n  $once ?: boolean;\n}\n\nexport default class Emitter {\n\n  static extend<T extends object>(target: T): T & Emitter {\n    let i, emitter:Emitter, keys;\n    if (target && typeof target === 'object') {\n      emitter = new Emitter();\n      ['$evt','on','off','once','emit','triggers']\n        .forEach((method: keyof Emitter) => { (<any>target)[method] = emitter[method] })\n    }\n    return <T & Emitter>target\n  }\n\n  private $evt: { [key: string]: Listener[] }\n\n  constructor() {\n    this.$evt = {}\n  }\n\n  public on(event: string, listener: Listener, context?: object|boolean, priority?:Boolean) : this {\n    let listeners, events = this.$evt;\n    if (event && listener) {\n      if (typeof context == 'boolean') {\n        priority = context\n        context = null\n      } else {\n        listener.$ctx = context\n      }\n      if (listeners = events[event]) {\n        // check and remove listener if it is already present\n        this.off(event, listener);\n        if (priority) {\n          listeners.unshift(listener)\n        } else {\n          listeners.push(listener)\n        }\n      } else {\n        listeners = <Listener[]>[listener]\n      }\n      events[event] = listeners\n    }\n    return this\n  }\n\n  public once(event: string, listener: Listener, context?: object, priority?:Boolean) : this {\n    if (event && listener) {\n      listener.$once = true\n      this.on(event, listener, context, priority)\n    }\n    return this\n  }\n\n  public off(event?: string, listener?: Function) : this {\n    let i, listeners, argNum = arguments.length, events = this.$evt\n    if (argNum === 0) {\n      this.$evt = {}\n    } else if (argNum === 1) {\n      delete events[event]\n    } else {\n      listeners = events[event]\n      i = listeners ? listeners.indexOf(listener) : -1\n      if (i > -1) {\n        listeners.splice(i, 1)\n        if (!listeners.length)\n          delete events[event]\n      }\n    }\n    return this;\n  }\n\n  public emit(event: string, args?:any[]) : this {\n    let i, listener, num,\n      listeners = this.$evt[event]\n    if (listeners && (num = listeners.length)) {\n      // get copy in case of mutations\n      listeners = listeners.slice()\n      for (i = 0; i < num; i++) {\n        listener = listeners[i]\n        // if listener returns \"stopEmit\" then do not invoke any other listeners\n        if (listener.apply(listener.$ctx, args) === \"stopEmit\")\n          i = num\n        if (listener.$once) {\n          this.off(event, listener)\n          delete listener.$once\n        }\n      }\n    }\n    return this\n  }\n\n  public triggers(event?: string, listener?: Function): boolean {\n    let listeners, argsNum = arguments.length, events = this.$evt\n    if (argsNum) {\n      if (listeners = events[event]) {\n        if (argsNum > 1) {\n          return listeners.indexOf(listener) > -1\n        } else {\n          return true\n        }\n      } else {\n        return false\n      }\n    } else {\n      return !!Object.getOwnPropertyNames(events).length\n    }\n  }\n\n}\n"],"sourceRoot":""}