{"version":3,"sources":["../src/Emitter.ts"],"names":[],"mappings":"AAKA;IAcE;QACE,IAAI,CAAC,IAAI,GAAG,EAAE,CAAA;IAChB,CAAC;IAdM,cAAM,GAAb,UAAgC,MAAS;QACvC,IAAI,CAAC,EAAE,OAAe,EAAE,IAAI,CAAC;QAC7B,IAAI,MAAM,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;YACxC,OAAO,GAAG,IAAI,OAAO,EAAE,CAAC;YACxB,CAAC,MAAM,EAAC,IAAI,EAAC,KAAK,EAAC,MAAM,EAAC,MAAM,EAAC,UAAU,CAAC;iBACzC,OAAO,CAAC,UAAC,MAAqB,IAAa,MAAO,CAAC,MAAM,CAAC,GAAG,OAAO,CAAC,MAAM,CAAC,CAAA,CAAC,CAAC,CAAC,CAAA;SACnF;QACD,OAAoB,MAAM,CAAA;IAC5B,CAAC;IAQM,oBAAE,GAAT,UAAU,KAAa,EAAE,QAAkB,EAAE,OAAwB,EAAE,QAAiB;QACtF,IAAI,SAAS,EAAE,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC;QAClC,IAAI,KAAK,IAAI,QAAQ,EAAE;YACrB,IAAI,OAAO,OAAO,IAAI,SAAS,EAAE;gBAC/B,QAAQ,GAAG,OAAO,CAAA;gBAClB,OAAO,GAAG,IAAI,CAAA;aACf;iBAAM;gBACL,QAAQ,CAAC,IAAI,GAAG,OAAO,CAAA;aACxB;YACD,IAAI,SAAS,GAAG,MAAM,CAAC,KAAK,CAAC,EAAE;gBAE7B,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;gBAC1B,IAAI,QAAQ,EAAE;oBACZ,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAA;iBAC5B;qBAAM;oBACL,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;iBACzB;aACF;iBAAM;gBACL,SAAS,GAAe,CAAC,QAAQ,CAAC,CAAA;aACnC;YACD,MAAM,CAAC,KAAK,CAAC,GAAG,SAAS,CAAA;SAC1B;QACD,OAAO,IAAI,CAAA;IACb,CAAC;IAEM,sBAAI,GAAX,UAAY,KAAa,EAAE,QAAkB,EAAE,OAAgB,EAAE,QAAiB;QAChF,IAAI,KAAK,IAAI,QAAQ,EAAE;YACrB,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAA;YACrB,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAA;SAC5C;QACD,OAAO,IAAI,CAAA;IACb,CAAC;IAEM,qBAAG,GAAV,UAAW,KAAc,EAAE,QAAmB;QAC5C,IAAI,CAAC,EAAE,SAAS,EAAE,MAAM,GAAG,SAAS,CAAC,MAAM,EAAE,MAAM,GAAG,IAAI,CAAC,IAAI,CAAA;QAC/D,IAAI,MAAM,KAAK,CAAC,EAAE;YAChB,IAAI,CAAC,IAAI,GAAG,EAAE,CAAA;SACf;aAAM,IAAI,MAAM,KAAK,CAAC,EAAE;YACvB,OAAO,MAAM,CAAC,KAAK,CAAC,CAAA;SACrB;aAAM;YACL,SAAS,GAAG,MAAM,CAAC,KAAK,CAAC,CAAA;YACzB,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAA;YAChD,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE;gBACV,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;gBACtB,IAAI,CAAC,SAAS,CAAC,MAAM;oBACnB,OAAO,MAAM,CAAC,KAAK,CAAC,CAAA;aACvB;SACF;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAEM,sBAAI,GAAX,UAAY,KAAa,EAAE,IAAW;QACpC,IAAI,CAAC,EAAE,QAAQ,EAAE,GAAG,EAClB,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;QAC9B,IAAI,SAAS,IAAI,CAAC,GAAG,GAAG,SAAS,CAAC,MAAM,CAAC,EAAE;YAEzC,SAAS,GAAG,SAAS,CAAC,KAAK,EAAE,CAAA;YAC7B,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;gBACxB,QAAQ,GAAG,SAAS,CAAC,CAAC,CAAC,CAAA;gBAEvB,IAAI,QAAQ,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,UAAU;oBACpD,CAAC,GAAG,GAAG,CAAA;gBACT,IAAI,QAAQ,CAAC,KAAK,EAAE;oBAClB,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAA;oBACzB,OAAO,QAAQ,CAAC,KAAK,CAAA;iBACtB;aACF;SACF;QACD,OAAO,IAAI,CAAA;IACb,CAAC;IAEM,0BAAQ,GAAf,UAAgB,KAAc,EAAE,QAAmB;QACjD,IAAI,SAAS,EAAE,OAAO,GAAG,SAAS,CAAC,MAAM,EAAE,MAAM,GAAG,IAAI,CAAC,IAAI,CAAA;QAC7D,IAAI,OAAO,EAAE;YACX,IAAI,SAAS,GAAG,MAAM,CAAC,KAAK,CAAC,EAAE;gBAC7B,IAAI,OAAO,GAAG,CAAC,EAAE;oBACf,OAAO,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAA;iBACxC;qBAAM;oBACL,OAAO,IAAI,CAAA;iBACZ;aACF;iBAAM;gBACL,OAAO,KAAK,CAAA;aACb;SACF;aAAM;YACL,OAAO,CAAC,CAAC,MAAM,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC,MAAM,CAAA;SACnD;IACH,CAAC;IAEH,cAAC;AAAD,CA1GA,AA0GC,IAAA","file":"Emitter.es3.browser.js","sourcesContent":["export interface Listener extends Function {\n  $ctx ?: object;\n  $once ?: boolean;\n}\n\nexport default class Emitter {\n\n  static extend<T extends object>(target: T): T & Emitter {\n    let i, emitter:Emitter, keys;\n    if (target && typeof target === 'object') {\n      emitter = new Emitter();\n      ['$evt','on','off','once','emit','triggers']\n        .forEach((method: keyof Emitter) => { (<any>target)[method] = emitter[method] })\n    }\n    return <T & Emitter>target\n  }\n\n  private $evt: { [key: string]: Listener[] }\n\n  constructor() {\n    this.$evt = {}\n  }\n\n  public on(event: string, listener: Listener, context?: object|boolean, priority?:Boolean) : this {\n    let listeners, events = this.$evt;\n    if (event && listener) {\n      if (typeof context == 'boolean') {\n        priority = context\n        context = null\n      } else {\n        listener.$ctx = context\n      }\n      if (listeners = events[event]) {\n        // check and remove listener if it is already present\n        this.off(event, listener);\n        if (priority) {\n          listeners.unshift(listener)\n        } else {\n          listeners.push(listener)\n        }\n      } else {\n        listeners = <Listener[]>[listener]\n      }\n      events[event] = listeners\n    }\n    return this\n  }\n\n  public once(event: string, listener: Listener, context?: object, priority?:Boolean) : this {\n    if (event && listener) {\n      listener.$once = true\n      this.on(event, listener, context, priority)\n    }\n    return this\n  }\n\n  public off(event?: string, listener?: Function) : this {\n    let i, listeners, argNum = arguments.length, events = this.$evt\n    if (argNum === 0) {\n      this.$evt = {}\n    } else if (argNum === 1) {\n      delete events[event]\n    } else {\n      listeners = events[event]\n      i = listeners ? listeners.indexOf(listener) : -1\n      if (i > -1) {\n        listeners.splice(i, 1)\n        if (!listeners.length)\n          delete events[event]\n      }\n    }\n    return this;\n  }\n\n  public emit(event: string, args?:any[]) : this {\n    let i, listener, num,\n      listeners = this.$evt[event]\n    if (listeners && (num = listeners.length)) {\n      // get copy in case of mutations\n      listeners = listeners.slice()\n      for (i = 0; i < num; i++) {\n        listener = listeners[i]\n        // if listener returns \"stopEmit\" then do not invoke any other listeners\n        if (listener.apply(listener.$ctx, args) === \"stopEmit\")\n          i = num\n        if (listener.$once) {\n          this.off(event, listener)\n          delete listener.$once\n        }\n      }\n    }\n    return this\n  }\n\n  public triggers(event?: string, listener?: Function): boolean {\n    let listeners, argsNum = arguments.length, events = this.$evt\n    if (argsNum) {\n      if (listeners = events[event]) {\n        if (argsNum > 1) {\n          return listeners.indexOf(listener) > -1\n        } else {\n          return true\n        }\n      } else {\n        return false\n      }\n    } else {\n      return !!Object.getOwnPropertyNames(events).length\n    }\n  }\n\n}\n"],"sourceRoot":""}